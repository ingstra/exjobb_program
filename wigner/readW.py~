import numpy as np
from numpy import kron
from numpy import sqrt
from scipy.linalg import expm
from scipy import integrate
import scipy as sp
import time
import functools
import itertools
import matplotlib.pylab as plt
from wigner_cmap import w_cmap


W=(array([[  1.30384284e-06,   4.31454304e-06,   1.24996840e-05,
          3.17042680e-05,   7.04029545e-05,   1.36873231e-04,
          2.32970336e-04,   3.47166016e-04,   4.52927050e-04,
          5.17337293e-04,   5.17337293e-04,   4.52927050e-04,
          3.47166016e-04,   2.32970336e-04,   1.36873231e-04,
          7.04029545e-05,   3.17042680e-05,   1.24996840e-05,
          4.31454304e-06,   1.30384284e-06],
       [  4.31454240e-06,   1.42772503e-05,   4.13626906e-05,
          1.04912555e-04,   2.32970336e-04,   4.52927051e-04,
          7.70921869e-04,   1.14880666e-03,   1.49878038e-03,
          1.71192024e-03,   1.71192024e-03,   1.49878038e-03,
          1.14880666e-03,   7.70921869e-04,   4.52927051e-04,
          2.32970336e-04,   1.04912555e-04,   4.13626906e-05,
          1.42772503e-05,   4.31454240e-06],
       [  1.24997039e-05,   4.13626744e-05,   1.19832017e-04,
          3.03942685e-04,   6.74939539e-04,   1.31217714e-03,
          2.23344141e-03,   3.32821338e-03,   4.34212398e-03,
          4.95961241e-03,   4.95961241e-03,   4.34212398e-03,
          3.32821338e-03,   2.23344141e-03,   1.31217714e-03,
          6.74939539e-04,   3.03942685e-04,   1.19832017e-04,
          4.13626744e-05,   1.24997039e-05],
       [  3.17042678e-05,   1.04912556e-04,   3.03942674e-04,
          7.70921870e-04,   1.71192024e-03,   3.32821336e-03,
          5.66491328e-03,   8.44169868e-03,   1.10133870e-02,
          1.25795883e-02,   1.25795883e-02,   1.10133870e-02,
          8.44169868e-03,   5.66491328e-03,   3.32821336e-03,
          1.71192024e-03,   7.70921870e-04,   3.03942674e-04,
          1.04912556e-04,   3.17042678e-05],
       [  7.04029547e-05,   2.32970336e-04,   6.74939490e-04,
          1.71192024e-03,   3.80151481e-03,   7.39067865e-03,
          1.25795883e-02,   1.87457580e-02,   2.44564862e-02,
          2.79344154e-02,   2.79344154e-02,   2.44564862e-02,
          1.87457580e-02,   1.25795883e-02,   7.39067865e-03,
          3.80151481e-03,   1.71192024e-03,   6.74939490e-04,
          2.32970336e-04,   7.04029547e-05],
       [  1.36873231e-04,   4.52927051e-04,   1.31217715e-03,
          3.32821336e-03,   7.39067865e-03,   1.43685172e-02,
          2.44564862e-02,   3.64443862e-02,   4.75468438e-02,
          5.43084265e-02,   5.43084265e-02,   4.75468438e-02,
          3.64443862e-02,   2.44564862e-02,   1.43685172e-02,
          7.39067865e-03,   3.32821336e-03,   1.31217715e-03,
          4.52927051e-04,   1.36873231e-04],
       [  2.32970336e-04,   7.70921870e-04,   2.23344149e-03,
          5.66491328e-03,   1.25795883e-02,   2.44564862e-02,
          4.16271010e-02,   6.20315662e-02,   8.09289303e-02,
          9.24377416e-02,   9.24377416e-02,   8.09289303e-02,
          6.20315662e-02,   4.16271010e-02,   2.44564862e-02,
          1.25795883e-02,   5.66491328e-03,   2.23344149e-03,
          7.70921870e-04,   2.32970336e-04],
       [  3.47166016e-04,   1.14880666e-03,   3.32821336e-03,
          8.44169868e-03,   1.87457580e-02,   3.64443862e-02,
          6.20315662e-02,   9.24377416e-02,   1.20598076e-01,
          1.37748192e-01,   1.37748192e-01,   1.20598076e-01,
          9.24377416e-02,   6.20315662e-02,   3.64443862e-02,
          1.87457580e-02,   8.44169868e-03,   3.32821336e-03,
          1.14880666e-03,   3.47166016e-04],
       [  4.52927050e-04,   1.49878038e-03,   4.34212391e-03,
          1.10133870e-02,   2.44564862e-02,   4.75468438e-02,
          8.09289303e-02,   1.20598076e-01,   1.57337206e-01,
          1.79711951e-01,   1.79711951e-01,   1.57337206e-01,
          1.20598076e-01,   8.09289303e-02,   4.75468438e-02,
          2.44564862e-02,   1.10133870e-02,   4.34212391e-03,
          1.49878038e-03,   4.52927050e-04],
       [  5.17337293e-04,   1.71192024e-03,   4.95961243e-03,
          1.25795883e-02,   2.79344154e-02,   5.43084265e-02,
          9.24377416e-02,   1.37748192e-01,   1.79711951e-01,
          2.05268584e-01,   2.05268584e-01,   1.79711951e-01,
          1.37748192e-01,   9.24377416e-02,   5.43084265e-02,
          2.79344154e-02,   1.25795883e-02,   4.95961243e-03,
          1.71192024e-03,   5.17337293e-04],
       [  5.17337293e-04,   1.71192024e-03,   4.95961243e-03,
          1.25795883e-02,   2.79344154e-02,   5.43084265e-02,
          9.24377416e-02,   1.37748192e-01,   1.79711951e-01,
          2.05268584e-01,   2.05268584e-01,   1.79711951e-01,
          1.37748192e-01,   9.24377416e-02,   5.43084265e-02,
          2.79344154e-02,   1.25795883e-02,   4.95961243e-03,
          1.71192024e-03,   5.17337293e-04],
       [  4.52927050e-04,   1.49878038e-03,   4.34212391e-03,
          1.10133870e-02,   2.44564862e-02,   4.75468438e-02,
          8.09289303e-02,   1.20598076e-01,   1.57337206e-01,
          1.79711951e-01,   1.79711951e-01,   1.57337206e-01,
          1.20598076e-01,   8.09289303e-02,   4.75468438e-02,
          2.44564862e-02,   1.10133870e-02,   4.34212391e-03,
          1.49878038e-03,   4.52927050e-04],
       [  3.47166016e-04,   1.14880666e-03,   3.32821336e-03,
          8.44169868e-03,   1.87457580e-02,   3.64443862e-02,
          6.20315662e-02,   9.24377416e-02,   1.20598076e-01,
          1.37748192e-01,   1.37748192e-01,   1.20598076e-01,
          9.24377416e-02,   6.20315662e-02,   3.64443862e-02,
          1.87457580e-02,   8.44169868e-03,   3.32821336e-03,
          1.14880666e-03,   3.47166016e-04],
       [  2.32970336e-04,   7.70921870e-04,   2.23344149e-03,
          5.66491328e-03,   1.25795883e-02,   2.44564862e-02,
          4.16271010e-02,   6.20315662e-02,   8.09289303e-02,
          9.24377416e-02,   9.24377416e-02,   8.09289303e-02,
          6.20315662e-02,   4.16271010e-02,   2.44564862e-02,
          1.25795883e-02,   5.66491328e-03,   2.23344149e-03,
          7.70921870e-04,   2.32970336e-04],
       [  1.36873231e-04,   4.52927051e-04,   1.31217715e-03,
          3.32821336e-03,   7.39067865e-03,   1.43685172e-02,
          2.44564862e-02,   3.64443862e-02,   4.75468438e-02,
          5.43084265e-02,   5.43084265e-02,   4.75468438e-02,
          3.64443862e-02,   2.44564862e-02,   1.43685172e-02,
          7.39067865e-03,   3.32821336e-03,   1.31217715e-03,
          4.52927051e-04,   1.36873231e-04],
       [  7.04029547e-05,   2.32970336e-04,   6.74939490e-04,
          1.71192024e-03,   3.80151481e-03,   7.39067865e-03,
          1.25795883e-02,   1.87457580e-02,   2.44564862e-02,
          2.79344154e-02,   2.79344154e-02,   2.44564862e-02,
          1.87457580e-02,   1.25795883e-02,   7.39067865e-03,
          3.80151481e-03,   1.71192024e-03,   6.74939490e-04,
          2.32970336e-04,   7.04029547e-05],
       [  3.17042678e-05,   1.04912556e-04,   3.03942674e-04,
          7.70921870e-04,   1.71192024e-03,   3.32821336e-03,
          5.66491328e-03,   8.44169868e-03,   1.10133870e-02,
          1.25795883e-02,   1.25795883e-02,   1.10133870e-02,
          8.44169868e-03,   5.66491328e-03,   3.32821336e-03,
          1.71192024e-03,   7.70921870e-04,   3.03942674e-04,
          1.04912556e-04,   3.17042678e-05],
       [  1.24997039e-05,   4.13626744e-05,   1.19832017e-04,
          3.03942685e-04,   6.74939539e-04,   1.31217714e-03,
          2.23344141e-03,   3.32821338e-03,   4.34212398e-03,
          4.95961241e-03,   4.95961241e-03,   4.34212398e-03,
          3.32821338e-03,   2.23344141e-03,   1.31217714e-03,
          6.74939539e-04,   3.03942685e-04,   1.19832017e-04,
          4.13626744e-05,   1.24997039e-05],
       [  4.31454240e-06,   1.42772503e-05,   4.13626906e-05,
          1.04912555e-04,   2.32970336e-04,   4.52927051e-04,
          7.70921869e-04,   1.14880666e-03,   1.49878038e-03,
          1.71192024e-03,   1.71192024e-03,   1.49878038e-03,
          1.14880666e-03,   7.70921869e-04,   4.52927051e-04,
          2.32970336e-04,   1.04912555e-04,   4.13626906e-05,
          1.42772503e-05,   4.31454240e-06],
       [  1.30384284e-06,   4.31454304e-06,   1.24996840e-05,
          3.17042680e-05,   7.04029545e-05,   1.36873231e-04,
          2.32970336e-04,   3.47166016e-04,   4.52927050e-04,
          5.17337293e-04,   5.17337293e-04,   4.52927050e-04,
          3.47166016e-04,   2.32970336e-04,   1.36873231e-04,
          7.04029545e-05,   3.17042680e-05,   1.24996840e-05,
          4.31454304e-06,   1.30384284e-06]]), array([[  1.46073879e-08,   1.47446626e-08,   1.48278406e-08,
          1.43849883e-08,   1.45557264e-08,   1.48814219e-08,
          1.43783613e-08,   1.31856471e-08,   1.33635363e-08,
          1.40843249e-08,   1.40843249e-08,   1.33635363e-08,
          1.31856471e-08,   1.43783613e-08,   1.48814219e-08,
          1.45557264e-08,   1.43849883e-08,   1.48278406e-08,
          1.47446626e-08,   1.46073879e-08],
       [  1.48559170e-08,   1.26485096e-08,   1.47392619e-08,
          1.18561603e-08,   1.48165466e-08,   1.34579375e-08,
          9.66725140e-09,   1.10268474e-08,   1.25862061e-08,
          1.35480750e-08,   1.35480750e-08,   1.25862061e-08,
          1.10268474e-08,   9.66725140e-09,   1.34579375e-08,
          1.48165467e-08,   1.18561603e-08,   1.47392619e-08,
          1.26485096e-08,   1.48559170e-08],
       [  1.46830706e-08,   1.47689442e-08,   1.45254223e-08,
          1.32111126e-08,   1.45207681e-08,   1.32136899e-08,
          1.41616275e-08,   1.33235242e-08,   1.46271551e-08,
          1.47849624e-08,   1.47849624e-08,   1.46271551e-08,
          1.33235242e-08,   1.41616275e-08,   1.32136899e-08,
          1.45207681e-08,   1.32111126e-08,   1.45254223e-08,
          1.47689442e-08,   1.46830706e-08],
       [  1.47607438e-08,   1.48505774e-08,   1.46402591e-08,
          1.45627004e-08,   1.44941907e-08,   1.39949464e-08,
          1.20786450e-08,   1.35440709e-08,   1.41219705e-08,
          1.25354262e-08,   1.25354262e-08,   1.41219705e-08,
          1.35440709e-08,   1.20786450e-08,   1.39949464e-08,
          1.44941907e-08,   1.45627004e-08,   1.46402591e-08,
          1.48505774e-08,   1.47607438e-08],
       [  1.48984821e-08,   1.47697531e-08,   1.44612311e-08,
          1.44046808e-08,   1.48541213e-08,   1.43873909e-08,
          1.48137870e-08,   1.39507411e-08,   1.44690566e-08,
          1.48291087e-08,   1.48291087e-08,   1.44690566e-08,
          1.39507411e-08,   1.48137870e-08,   1.43873909e-08,
          1.48541213e-08,   1.44046808e-08,   1.44612311e-08,
          1.47697531e-08,   1.48984821e-08],
       [  1.47061905e-08,   1.47751248e-08,   1.48062293e-08,
          1.48178712e-08,   1.45328229e-08,   1.44337299e-08,
          1.42343741e-08,   1.46907681e-08,   1.43355602e-08,
          1.44840849e-08,   1.44840849e-08,   1.43355602e-08,
          1.46907681e-08,   1.42343741e-08,   1.44337300e-08,
          1.45328229e-08,   1.48178712e-08,   1.48062293e-08,
          1.47751248e-08,   1.47061905e-08],
       [  1.36581341e-08,   1.46954414e-08,   1.45099201e-08,
          1.48555255e-08,   1.46607904e-08,   1.47281857e-08,
          1.48935498e-08,   1.47205731e-08,   1.45821885e-08,
          1.43373737e-08,   1.43373737e-08,   1.45821885e-08,
          1.47205731e-08,   1.48935498e-08,   1.47281858e-08,
          1.46607904e-08,   1.48555255e-08,   1.45099201e-08,
          1.46954414e-08,   1.36581341e-08],
       [  1.26893316e-08,   1.44631649e-08,   1.46966246e-08,
          1.42571572e-08,   1.43423615e-08,   1.42338017e-08,
          1.48931593e-08,   1.40721589e-08,   1.20819817e-08,
          1.38171495e-08,   1.38171495e-08,   1.20819818e-08,
          1.40721589e-08,   1.48931593e-08,   1.42338017e-08,
          1.43423615e-08,   1.42571572e-08,   1.46966246e-08,
          1.44631649e-08,   1.26893316e-08],
       [  1.47148837e-08,   1.48972167e-08,   1.47593525e-08,
          1.39947060e-08,   1.48164664e-08,   1.45584966e-08,
          1.44187704e-08,   1.46231300e-08,   1.48919850e-08,
          1.48789587e-08,   1.48789587e-08,   1.48919850e-08,
          1.46231300e-08,   1.44187704e-08,   1.45584966e-08,
          1.48164664e-08,   1.39947060e-08,   1.47593525e-08,
          1.48972167e-08,   1.47148837e-08],
       [  1.40061237e-08,   1.43164779e-08,   1.43362658e-08,
          1.43687103e-08,   1.31046225e-08,   1.46827732e-08,
          1.21822720e-08,   1.48009720e-08,   1.44251674e-08,
          1.39488283e-08,   1.39488283e-08,   1.44251674e-08,
          1.48009720e-08,   1.21822720e-08,   1.46827732e-08,
          1.31046226e-08,   1.43687103e-08,   1.43362658e-08,
          1.43164779e-08,   1.40061237e-08],
       [  1.40061237e-08,   1.43164779e-08,   1.43362658e-08,
          1.43687103e-08,   1.31046225e-08,   1.46827732e-08,
          1.21822720e-08,   1.48009720e-08,   1.44251674e-08,
          1.39488283e-08,   1.39488283e-08,   1.44251674e-08,
          1.48009720e-08,   1.21822720e-08,   1.46827732e-08,
          1.31046226e-08,   1.43687103e-08,   1.43362658e-08,
          1.43164779e-08,   1.40061237e-08],
       [  1.47148837e-08,   1.48972166e-08,   1.47593525e-08,
          1.39947059e-08,   1.48164664e-08,   1.45584966e-08,
          1.44187703e-08,   1.46231300e-08,   1.48919850e-08,
          1.48789587e-08,   1.48789587e-08,   1.48919850e-08,
          1.46231300e-08,   1.44187704e-08,   1.45584966e-08,
          1.48164664e-08,   1.39947060e-08,   1.47593525e-08,
          1.48972166e-08,   1.47148837e-08],
       [  1.26893316e-08,   1.44631649e-08,   1.46966246e-08,
          1.42571572e-08,   1.43423615e-08,   1.42338017e-08,
          1.48931593e-08,   1.40721589e-08,   1.20819818e-08,
          1.38171495e-08,   1.38171495e-08,   1.20819818e-08,
          1.40721589e-08,   1.48931593e-08,   1.42338017e-08,
          1.43423615e-08,   1.42571572e-08,   1.46966246e-08,
          1.44631649e-08,   1.26893316e-08],
       [  1.36581341e-08,   1.46954413e-08,   1.45099201e-08,
          1.48555255e-08,   1.46607904e-08,   1.47281857e-08,
          1.48935498e-08,   1.47205731e-08,   1.45821885e-08,
          1.43373737e-08,   1.43373737e-08,   1.45821885e-08,
          1.47205731e-08,   1.48935498e-08,   1.47281857e-08,
          1.46607904e-08,   1.48555255e-08,   1.45099201e-08,
          1.46954413e-08,   1.36581341e-08],
       [  1.47061905e-08,   1.47751248e-08,   1.48062292e-08,
          1.48178712e-08,   1.45328229e-08,   1.44337300e-08,
          1.42343741e-08,   1.46907681e-08,   1.43355602e-08,
          1.44840849e-08,   1.44840849e-08,   1.43355602e-08,
          1.46907681e-08,   1.42343741e-08,   1.44337299e-08,
          1.45328229e-08,   1.48178712e-08,   1.48062292e-08,
          1.47751248e-08,   1.47061905e-08],
       [  1.48984821e-08,   1.47697531e-08,   1.44612311e-08,
          1.44046807e-08,   1.48541213e-08,   1.43873909e-08,
          1.48137870e-08,   1.39507411e-08,   1.44690566e-08,
          1.48291087e-08,   1.48291087e-08,   1.44690566e-08,
          1.39507411e-08,   1.48137870e-08,   1.43873909e-08,
          1.48541213e-08,   1.44046808e-08,   1.44612311e-08,
          1.47697531e-08,   1.48984821e-08],
       [  1.47607438e-08,   1.48505774e-08,   1.46402591e-08,
          1.45627004e-08,   1.44941907e-08,   1.39949464e-08,
          1.20786450e-08,   1.35440709e-08,   1.41219705e-08,
          1.25354262e-08,   1.25354262e-08,   1.41219705e-08,
          1.35440709e-08,   1.20786450e-08,   1.39949464e-08,
          1.44941907e-08,   1.45627004e-08,   1.46402591e-08,
          1.48505774e-08,   1.47607438e-08],
       [  1.46830706e-08,   1.47689442e-08,   1.45254223e-08,
          1.32111126e-08,   1.45207681e-08,   1.32136899e-08,
          1.41616275e-08,   1.33235242e-08,   1.46271551e-08,
          1.47849624e-08,   1.47849624e-08,   1.46271551e-08,
          1.33235242e-08,   1.41616275e-08,   1.32136899e-08,
          1.45207681e-08,   1.32111126e-08,   1.45254223e-08,
          1.47689442e-08,   1.46830706e-08],
       [  1.48559170e-08,   1.26485096e-08,   1.47392619e-08,
          1.18561603e-08,   1.48165466e-08,   1.34579375e-08,
          9.66725140e-09,   1.10268474e-08,   1.25862061e-08,
          1.35480750e-08,   1.35480750e-08,   1.25862061e-08,
          1.10268474e-08,   9.66725140e-09,   1.34579375e-08,
          1.48165467e-08,   1.18561603e-08,   1.47392619e-08,
          1.26485096e-08,   1.48559170e-08],
       [  1.46073879e-08,   1.47446626e-08,   1.48278406e-08,
          1.43849883e-08,   1.45557264e-08,   1.48814219e-08,
          1.43783613e-08,   1.31856471e-08,   1.33635363e-08,
          1.40843249e-08,   1.40843249e-08,   1.33635363e-08,
          1.31856471e-08,   1.43783613e-08,   1.48814219e-08,
          1.45557264e-08,   1.43849883e-08,   1.48278406e-08,
          1.47446626e-08,   1.46073879e-08]]))
